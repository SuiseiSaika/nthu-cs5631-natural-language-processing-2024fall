<!DOCTYPE html>
<html>
<head>
<title>README.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="cs563100-natural-language-processing---assignment-4-retrieval-augmented-generation-with-langchain">CS563100 Natural Language Processing - Assignment 4: Retrieval-Augmented Generation with LangChain</h1>
<h2 id="experimental-setup">Experimental Setup</h2>
<p><strong>Running Environment:</strong> Colab
<strong>Python Version:</strong> Colab</p>
<h2 id="experiments">Experiments</h2>
<h3 id="rag-system-components">RAG System Components</h3>
<p>My RAG system incorporates the following key components:</p>
<ul>
<li><strong>Retrieval:</strong>
<ul>
<li><strong>Vector Database:</strong> Chroma</li>
<li><strong>Retrieval Method:</strong> MMR</li>
<li><strong>Embedding Models (Evaluated):</strong> Jina AI (<code>jinaai/jina-embeddings-v2-base-en</code>, <code>jinaai/jina-embedding-b-en-v1</code>), Sentence Transformers (<code>all-MiniLM-L12-v2</code>, <code>paraphrase-MiniLM-L6-v2</code>), BERT (<code>bert-base-multilingual-cased</code>, <code>bert-base-multilingual-uncased</code>), Hugging Face (<code>distilbert-base-cased/uncased</code>, <code>roberta-base</code>, <code>roberta-large</code>, <code>xlm-roberta-base</code>, <code>all-mpnet-base-v2</code>).</li>
</ul>
</li>
<li><strong>Generation Model (Evaluated):</strong> Llama 3.2 (<code>llama3.2:1b</code>, <code>llama3.2:3b</code>), Gemma 2 (<code>gemma2:2b</code>), Phi (<code>phi3:mini</code>).</li>
</ul>
<p>The primary retrieval model used in the experiments was <code>jinaai/jina-embeddings-v2-base-en</code>.</p>
<h3 id="prompt-engineering">Prompt Engineering</h3>
<p>Eight different prompt scenarios were tested, each appended with the common suffix: &quot;Answer the question shortly and professionally using the most relevant information from the provided documents.&quot; Table 1-4 detail the prompts and the number of correct answers obtained using <code>llama3.2:1b</code>, <code>gemma2:2b</code>, <code>llama3.2:3b</code>, and <code>phi3:mini</code> respectively. Subsequent experiments utilized <code>llama3.2:3b</code> and the prompt: &quot;You are an expert on feline biology and behavior. Your role is to provide precise and accurate answers to questions about cats based on the most relevant context from the provided documents.&quot;</p>
<p><strong>TABLE 1.</strong> Prompt Performance with <code>llama3.2:1b</code></p>
<table>
<thead>
<tr>
<th>Prompt</th>
<th>Correct numbers</th>
</tr>
</thead>
<tbody>
<tr>
<td>&quot;You are a highly knowledgeable assistant. Your task is to answer questions about cats. &quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;You are an expert on feline biology and behavior. Your role is to provide precise and accurate answers to questions about cats based on the most relevant context from the provided documents.&quot;</td>
<td>8</td>
</tr>
<tr>
<td>&quot;You are a concise and precise assistant. Answer the questions about cats using the context provided, keeping your answers as brief and accurate as possible.&quot;</td>
<td>5</td>
</tr>
<tr>
<td>&quot;You are a knowledgeable assistant specializing in cat-related information. Use the provided context to answer questions in a bullet-point format, emphasizing key facts.&quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;You are a cat expert educating an audience. Provide comprehensive and easy-to-understand answers about cats, using information from the provided documents.&quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;You are a detail-oriented assistant. When answering questions about cats, provide not only the answer but also an explanation of the reasons or mechanisms behind it, using the context provided.&quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;Imagine you are a cat explaining your life and behavior. Use the provided context to answer questions in a way that reflects a cat's perspective.&quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;You are a storyteller specializing in cats. When answering questions, incorporate a short narrative to explain the information in an engaging way.&quot;</td>
<td>7</td>
</tr>
</tbody>
</table>
<p><strong>TABLE 2.</strong> Prompt Performance with <code>gemma2:2b</code></p>
<table>
<thead>
<tr>
<th>Prompt</th>
<th>Correct numbers</th>
</tr>
</thead>
<tbody>
<tr>
<td>&quot;You are a highly knowledgeable assistant. Your task is to answer questions about cats.&quot;</td>
<td>6</td>
</tr>
<tr>
<td>&quot;You are an expert on feline biology and behavior. Your role is to provide precise and accurate answers to questions about cats based on the most relevant context from the provided documents.&quot;</td>
<td>6</td>
</tr>
<tr>
<td>&quot;You are a concise and precise assistant. Answer the questions about cats using the context provided, keeping your answers as brief and accurate as possible.&quot;</td>
<td>6</td>
</tr>
<tr>
<td>&quot;You are a knowledgeable assistant specializing in cat-related information. Use the provided context to answer questions in a bullet-point format, emphasizing key facts.&quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;You are a cat expert educating an audience. Provide comprehensive and easy-to-understand answers about cats, using information from the provided documents.&quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;You are a detail-oriented assistant. When answering questions about cats, provide not only the answer but also an explanation of the reasons or mechanisms behind it, using the context provided.&quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;Imagine you are a cat explaining your life and behavior. Use the provided context to answer questions in a way that reflects a cat's perspective.&quot;</td>
<td>1</td>
</tr>
<tr>
<td>&quot;You are a storyteller specializing in cats. When answering questions, incorporate a short narrative to explain the information in an engaging way.&quot;</td>
<td>5</td>
</tr>
</tbody>
</table>
<p><strong>TABLE 3.</strong> Prompt Performance with <code>llama3.2:3b</code></p>
<table>
<thead>
<tr>
<th>Prompt</th>
<th>Correct numbers</th>
</tr>
</thead>
<tbody>
<tr>
<td>&quot;You are a highly knowledgeable assistant. Your task is to answer questions about cats.&quot;</td>
<td>9</td>
</tr>
<tr>
<td>&quot;You are an expert on feline biology and behavior. Your role is to provide precise and accurate answers to questions about cats based on the most relevant context from the provided documents.&quot;</td>
<td>8</td>
</tr>
<tr>
<td>&quot;You are a concise and precise assistant. Answer the questions about cats using the context provided, keeping your answers as brief and accurate as possible.&quot;</td>
<td>5</td>
</tr>
<tr>
<td>&quot;You are a knowledgeable assistant specializing in cat-related information. Use the provided context to answer questions in a bullet-point format, emphasizing key facts.&quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;You are a cat expert educating an audience. Provide comprehensive and easy-to-understand answers about cats, using information from the provided documents.&quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;You are a detail-oriented assistant. When answering questions about cats, provide not only the answer but also an explanation of the reasons or mechanisms behind it, using the context provided.&quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;Imagine you are a cat explaining your life and behavior. Use the provided context to answer questions in a way that reflects a cat's perspective.&quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;You are a storyteller specializing in cats. When answering questions, incorporate a short narrative to explain the information in an engaging way.&quot;</td>
<td>7</td>
</tr>
</tbody>
</table>
<p><strong>TABLE 4.</strong> Prompt Performance with <code>phi3:mini</code></p>
<table>
<thead>
<tr>
<th>Prompt</th>
<th>Correct numbers</th>
</tr>
</thead>
<tbody>
<tr>
<td>&quot;You are a highly knowledgeable assistant. Your task is to answer questions about cats.&quot;</td>
<td>5</td>
</tr>
<tr>
<td>&quot;You are an expert on feline biology and behavior. Your role is to provide precise and accurate answers to questions about cats based on the most relevant context from the provided documents.&quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;You are a concise and precise assistant. Answer the questions about cats using the context provided, keeping your answers as brief and accurate as possible.&quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;You are a knowledgeable assistant specializing in cat-related information. Use the provided context to answer questions in a bullet-point format, emphasizing key facts.&quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;You are a cat expert educating an audience. Provide comprehensive and easy-to-understand answers about cats, using information from the provided documents.&quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;You are a detail-oriented assistant. When answering questions about cats, provide not only the answer but also an explanation of the reasons or mechanisms behind it, using the context provided.&quot;</td>
<td>6</td>
</tr>
<tr>
<td>&quot;Imagine you are a cat explaining your life and behavior. Use the provided context to answer questions in a way that reflects a cat's perspective.&quot;</td>
<td>7</td>
</tr>
<tr>
<td>&quot;You are a storyteller specializing in cats. When answering questions, incorporate a short narrative to explain the information in an engaging way.&quot;</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>The highest score achieved across the ten questions was 9 correct answers, obtained with <code>llama3.2:3b</code> as the generation model, <code>jina-embeddings-v2-base-en</code> as the retrieval model, and the prompt: &quot;You are a highly knowledgeable assistant. Your task is to answer questions about cats. Answer the question shortly and professionally using the most relevant information from the provided documents.&quot;</p>
<h3 id="rag-performance-analysis-with-different-prompts">RAG Performance Analysis with Different Prompts</h3>
<p>Table 5 shows the number of prompts that resulted in incorrect answers for each question when using <code>llama3.2:3b</code>. Questions 3 and 5 were the most frequently answered incorrectly across different prompts (a similar trend was observed with <code>phi3:mini</code>), while Question 10 had the fewest incorrect answers.</p>
<p><strong>TABLE 5.</strong> Incorrect Answers per Question with <code>llama3.2:3b</code></p>
<table>
<thead>
<tr>
<th>QuestionID</th>
<th># of prompts that make the mistake</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>5</td>
</tr>
<tr>
<td>4</td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>6</td>
</tr>
<tr>
<td>6</td>
<td>0</td>
</tr>
<tr>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>8</td>
<td>3</td>
</tr>
<tr>
<td>9</td>
<td>1</td>
</tr>
<tr>
<td>10</td>
<td>3</td>
</tr>
</tbody>
</table>
<h3 id="comparison-with-different-retrieval-models-and-without-rag">Comparison with Different Retrieval Models and Without RAG</h3>
<p>The RAG performance was compared using various retrieval models (with <code>llama3.2:3b</code> as the generator):</p>
<ul>
<li><code>bert-base-multilingual-uncased</code>: 3 correct answers</li>
<li><code>bert-base-multilingual-cased</code>: 4 correct answers</li>
<li><code>sentence-transformers/all-MiniLM-L12-v2</code>: 4 correct answers</li>
<li><code>sentence-transformers/paraphrase-MiniLM-L6-v2</code>: <strong>8 correct answers</strong></li>
<li><code>distilbert-base-uncased</code>: 6 correct answers</li>
<li><code>distilbert-base-cased</code>: 4 correct answers</li>
<li><code>jinaai/jina-embedding-b-en-v1</code>: 7 correct answers</li>
<li><code>all-mpnet-base-v2</code>: 7 correct answers</li>
<li><code>FacebookAI/roberta-base</code>: 4 correct answers</li>
<li><code>FacebookAI/roberta-large</code>: 2 correct answers</li>
<li><code>FacebookAI/xlm-roberta-base</code>: 5 correct answers</li>
</ul>
<p><strong>Without using RAG</strong> (only <code>llama3.2:3b</code>), the number of correct answers was 4. The language model's direct responses often deviated from the expected answers and provided incorrect information.</p>
<h2 id="reference">Reference</h2>
<p>Sample code / Data: <a href="https://github.com/IKMLab/NTHU_Natural_Language_Processing/tree/main/Assignments/Assignment4">IKMLab Github</a></p>

</body>
</html>
